= Developer Guide
:site-section: DeveloperGuide
:toc:
:toc-title:
:imagesDir: images
:stylesDir: stylesheets
:experimental:

== Introduction
The purpose of this Developer Guide is to provide useful information to software developers who desire to contribute to the project (e.g. optimizing of code, adding test cases, etc.), including an overview of the software architecture, design as well as current implementations and intended functionality of current features. The police database is for police officers(PO) and headquarters personnel(HQP). Both groups will have varying access and authorization levels to this database. POs would be able to read from the database after screening someone while on patrol and choose his course of action base on the status/threat level of subject. HQP would have the added functions of adding and removing people from the database. Refer to quick start to get started.

== Setting up
To set up the project successfully on your computer, follow the steps below.

=== Prerequisites
In order to start the setup, you are required to install the following:

* JDK 9 or later
* IntelliJ IDE

=== Importing the project into IntelliJ

. Open IntelliJ (if you are not in the welcome screen, click `File` > `Close Project` to close the existing project dialog first)
. Set up the correct JDK version
.. Click `Configure` > `Project Defaults` > `Project Structure`
.. If JDK 9 is listed in the drop down, select it. If it is not, click `New...` and select the directory where you installed JDK 9
.. Click `OK`
. Click `Import Project`
. Locate the `build.gradle` file and select it. Click `OK`
. Click `Open as Project`
. Click `OK` to accept the default settings
. Run the `F10-3.EX-SI-03.Main` class (right-click the `Main` class and click `Run Main.main()`) and try executing a few commands
. Run all the tests (right-click the `test` folder, and click `Run 'All Tests'`) and ensure that they pass
. Open the `StorageFile` file and check for any code errors
.. Due to an ongoing https://youtrack.jetbrains.com/issue/IDEA-189060[issue] with some of the newer versions of IntelliJ, code errors may be detected even if the project can be built and run successfully
.. To resolve this, place your cursor over any of the code section highlighted in red. Press kbd:[ALT + ENTER], and select `Add '--add-modules=java.xml.bind' to module compiler options`

== Design
The diagram below shows a high level architecture design of the current classes that are used in the project.

image::mainClassDiagram.png[]

== Implementation
This section describes some of the more important details of certain features implemented.

== Use Cases
The use cases for the current features and commands implemented can be found in Appendix B.

== Testing
To run tests for the project, complete the step below.

* In IntelliJ, right-click on the `test` folder and choose `Run 'All Tests'`

[appendix]
== User Stories

Priorities: High (must have) - `* * \*`, Medium (nice to have) - `* \*`, Low (unlikely to have) - `*`

PO- Police Officer
AD- Ambulance Driver
TD- Fire Truck Driver

[width="100%",cols="22%,<23%,<25%,<30%",options="header",]
|===========================================================================================================================================
|Priority |As a ... |I want to ... |So that I can...
|`* * *` |PO |request backup efficiently and quickly |get help in dangerous situations like capturing an escaped criminal, saving a person’s life
|`* * *` |PO |know if accused is dangerous |know the steps I should take to handle the accused
|`* * *` |AD |know the severity of the accident |prepare myself and my men
|`* * *` |TD |know the severity of the fire |prepare myself and my men
|`* *` |PO |update HQ |let HQ know if I’m free or engaged
|`* *` |PO |know next actions to be taken |respond effectively to any type of situation
|`*` |PO |know the serial number and battery level |to return it to HQ and charge it when necessary
|===========================================================================================================================================

[appendix]
== Use Cases

(For all use cases below, the *System* is the `AddressBook` and the *User* is either the `Police Officer (PO)' or 'Head Quarters Personnel (HQP)', unless specified otherwise)

=== Use case: Enter Headquarter Personnel password

*MSS*
. System prompts User to enter his password.
. User enters HQP password.
. System displays message "Welcome Headquarter Personnel" and System prompts User for a command. Only HQP commands are set to accessible.
+
Use case ends.

*Extensions*

* 2a. User enters invalid password.
** 2a1. System displays an error message and allows one less attempt for User at entering a correct password, with a a maximum of 5 attempts.
+
Use case resumes at step 1.

** 2a1a. The number of attempts reaches zero.
*** 2a1b. System shuts down.
+
Use case ends.

=== Use case: Enter Police Officer password

*MSS*

. System prompts User to enter his password.
. User enters Police Officer password.
. Only Police Officer commands are set to accessible, System displays message "Welcome Police Officer" and System prompts User for a command.
+
Use case ends.

*Extensions*

* 2a. User enters invalid password.
** 2a1. System displays an error message and allows one less attempt for User at entering a correct password, with a a maximum of 5 attempts.
+
Use case resumes at step 1.

** 2a1a. The number of attempts reaches zero.
*** 2a1b. System shuts down.
+
Use case ends.

=== Use case: Lock System

*MSS*

. User locks the System at any point.
. System sets all commands to inaccessible, displays System lock message and prompts User for password.

Use case ends.

=== Use case: Update any password

*MSS*

. User requests to update password.
. System prompts User for current password to change.
. User enters existing password.
. System prompts User to enter new password.
. User enters new alphanumeric password.
. System prompts User to enter new password again.
. User enters same new alphanumeric password.
. System updates password to change to the new alphanumeric password and displays update password success message. 
+
Use case ends.

*Extensions*

* 3a. User enters invalid password.
** 3a1. System displays an error message and allows one less attempt for User at entering a correct password, with a a maximum of 5 attempts.
+
Use case resumes at step 2.

** 3a1a. The number of attempts reaches zero.
*** 3a1b. System shuts down.
+
Use case ends.

* 5a or 7a. User enters new password without a number.
* 5a1 or 7a1. System shows error message to include at least one number and prompts User to enter new alphanumeric password again.
+
Use case resumes at step 5.

* 5b or 7b. User enters new password without a letter.
* 5b1 or 7b1. System shows error message to include at least one letter and prompts User to enter new alphanumeric password again.
+
Use case resumes at step 5. 

* 5c or 7c. User enters new password without a letter nor a number.
* 5c1 or 7c1. System shows error message for invalid new password.
+
Use case resumes at step 5. 

=== Use case: Add person

*MSS*

. User requests to add person to the list.
. System adds person to the list and informs User that person has been successfully added.
+
Use case ends.

*Extensions*

* 2a. Person already exists in the list.
** 2a1. System shows an error message.
+
Use case ends.

* 2b. User enters person’s details with invalid formats.
** 2b1. System shows an error message.
+
Use case resumes at step 1.

* *a. At any time, User cancels add action.
* *a1. System requests for confirmation to cancel.
* *a2. User confirms cancellation.
+
Use case ends.


=== Use case: Delete person

*MSS*

. System prompts user to enter his password.
. User enters password.
. System prompts user to enter his command.
. User keys in NRIC of person to delete
. System deletes the person. 
. User requests to list persons.
. System shows a list of persons.
. User requests to delete a specific person in the list.
. System deletes the person.
+
Use case ends.

*Extensions*

* 2a. User enters an invalid password.
** 2a1. System shows an error message.
+
Use case resumes at step 1.

* 4a. The list is empty.
** 4a1. System shows an error message
+
Use case ends.

* 4b. User enters invalid NRIC.
** 4b1. System shows an error message.
+
Use case ends.

* 4c. User enters an NRIC that does not exist in the system.
** 4c1. System shows an error message.
+
Use case resumes at step 3.

* *a. At any time, User chooses to cancel the delete action.
** *a1. System requests confirmation to cancel.
** *a2. User confirms the cancellation.
+
Use case ends.


=== Use case: Edit person

*MSS*

. User requests to edit persons.
. System shows a list of persons.
. User requests to update a specific person in the list.
. System edits the person’s respective details.
+
Use case ends.

*Extensions*

* 1a. The list is empty.
** 1a1. System shows an error message.
+
Use case ends.

* 3a. User enters person's details with invalid format.
** 3a1. System shows an error message.
+
Use case resumes at step 3.

* *a. At any time, User chooses to cancel the delete action.
** *a1. System requests confirmation to cancel.
** *a2. User confirms the cancellation.
+
Use case ends.
	

=== Use case: Find person

*MSS*

. User requests to find person
. System prompts User to enter his password
. User enters his password
. System prompts User to key in NRIC to find
. User enters NRIC of person
. System displays details of person, if found on the list.
+
Use case ends.

*Extensions*


* 3a. User enters an invalid password.
** 3a1. System shows an error message.
+
Use case resumes in step 2.

* 5a. User enters person's NRIC with invalid format.
** 5a1. System shows an error message.
+
Use case resumes at step 4.

* 5b. The list of persons is empty.
** 5b1. System shows an error message.
+
Use case ends.

* 5a. User enters an NRIC that does not exist in the list.
** 5a1. System informs User that person is not in the list.
+
Use case ends.

* *a. At any time, User chooses to cancel the delete action.
** *a1. System requests confirmation to cancel.
** *a2. User confirms the cancellation.
+
Use case ends.

=== Use case: Check

*MSS*

. User requests to check person's screening history.
. System prompts User to enter his password.
. User enters his password.
. System prompts User to key in NRIC to check.
. User enters NRIC of person.
. System displays past screening timestamps of person, if found on the list.
+
Use case ends.

*Extensions*

* 1a. The list is empty.
** 1a1. System shows an error message.
+
Use case ends.

* 3a. User enters an invalid password.
** 3a1. System shows an error message.
+
Use case ends.

* 3b. User enters person's details with invalid format.
** 3b1. System shows an error message.
+
Use case resumes at step 3.

* 5a. User enters an NRIC that does not exist in the list.
** 5a1. System informs User that person is not in the list.
+
Use case ends.

* 5b. User enters the an NRIC with invalid format.
** 5b1. System shows an error message.
+
Use case ends.

* 5c. The list of persons is empty.
** 5c1. System shows an error message.
+
Use case ends.

* 5d. User enters an NRIC that does not exist in the list.
** 5d1. System informs User that person is not in the list.
+
Use case ends.


* *a. At any time, User chooses to cancel the delete action.
** *a1. System requests confirmation to cancel.
** *a2. User confirms the cancellation.
+
Use case ends.


=== Use case: Autoprediction

*MSS*

. User enters invalid input.
. System predicts what the user would have wanted to type and displays the list of valid inputs, if any.
+
Use case ends.


*Extensions*

* 1a. User enters an invalid input which is an invalid command.
** 1a1. System also displays the valid usage of the command.
+
Use case ends.

* *a. At any time, user chooses to cancel the delete action.
** *a1. System requests confirmation to cancel.
** *a2. User confirms the cancellation.
+
Use case ends.


=== Use case: Load messages

*MSS*

. User requests to display messages in inbox.
. System prints the number of unread messages, total messages and list of messages.
+
Use case ends.

*Extensions*

* 1a. There are no messages.
** 1a1. System informs user that there are no messages available.
+
Use case ends.

* 1b. There are no unread messages.
** 1b1. System informs user that there are no unread messages and prints the last 5 messages stored.
+
Use case ends.

=== Use case: Reply messages

*MSS*

. User enters the message number he wishes to reply to.
. System displays the list of possible responses to message.
. User enters the number of the response he chooses.
. System updates message read status to 'read' and sends response message to recipient.
+
Use case ends.

*Extensions*

* 1a. User enters an invalid message number.
** 1a1. System shows an error message.
+
Use case ends.

* 1b. There are no unread messages.
** 1b1. System informs user that there are no messages to respond to.
+
Use case ends.

* 3a. User enters an invalid response number.
** 3a1. System shows an error message.
+
Use case resumes at step 2.

* *a. At anytime, user chooses to cancel response to message.
** *a1. System requests for user confirmation for cancellation.
** *a2. User confirms the cancellation.
+
Use case ends.

=== Use Case: Request Backup

*MSS*

. System prompts User to enter his password.
. User enters his password.
. System prompts User to key in command.
. User types in to request backup with pre-defined case types and message.
. System adds message into Headquarters inbox.
. User will be notified with success message.
+
Use case ends.

*Extensions*

* 2a. User enters an invalid password.
** 2a1. System shows an error message.
+
Use case resumes in step 1.

* 4a. User enters an invalid input with invalid command format.
** 4a1. System shows error message and prompts correct format for request feature.
+
Use case resumes from step 3.

* 6a. User enters an invalid case type.
** 6a1. System shows an error message and prompts current valid case types.
+
Use case resumes at step 3.

=== Use Case: Dispatch Backup

*MSS*

. System prompts User to enter his password.
. User enters his password.
. System prompts User to key in command.
. User lists the current unread messages inside the inbox.
. System shows unread inbox messages and marks them as read.
. User types to dispatch backup with index of police officer +
which requested backup and police officer to dispatch.
. System adds new message with ETA in police officer which requested backup.
. System adds new message with destination coordinates to dispatch idle police officer.
+
Use case ends.

*Extensions*

* 0a. User keys in invalid command format.
** 0a1. System shows error message and prompts correct format for dispatch feature.
+
Use case resumes from step 3.

* 2a. The entered password is invalid.
** 2a1. System shows an error message.
+
Use case resumes in step 1.

* 4a. User is not a Headquarter Personnel.
** 4a1. System shows an error message stating invalid credentials.
+
Use case resumes in step 3.

* 6a. User enters an invalid index entered for police officer to be dispatched.
** 6a1. System shows an error message.
+
Use case resumes in step 3.

* 6a. User enters an invalid index for police officer requesting backup.
** 6a1. System shows an error message.
+
Use case resumes at step 3.


[appendix]

== Non Functional Requirements

. Should work on any <<mainstream-os, mainstream OS>> as long as it has Java 9 or higher installed.
. Should be able to hold up to 1000 persons.
. Should come with automated unit tests and open source code.
. Should favor DOS style commands over Unix-style commands.
. Business/domain rules:
.. Device should accept any more input after 9 characters when PO is inputting NRIC
.. Device will constantly remind PO to charge if battery level goes below a certain level.
. Accessibility: Different levels of access for POs and HQPs and drivers (ambulance,fire truck).
. Performance requirements: The system should respond within two seconds.
. Security requirements: The system should be password locked.
. Data requirements:
.. Data should be constant, not volatile.
.. Data should be recoverable from last save point


[appendix]
== Glossary

[[mainstream-os]] Mainstream OS::
Windows, Linux, Unix, OS-X

[[private-contact-detail]] Private contact detail::
A contact detail that is not meant to be shared with others.
